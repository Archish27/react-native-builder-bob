(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[746],{7040:function(e,n,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/faq",function(){return i(5510)}])},5510:function(e,n,i){"use strict";i.r(n),i.d(n,{__toc:function(){return l}});var s=i(4246),t=i(9304),r=i(2917),a=i(6282);i(6288);var o=i(1441);let l=[{depth:2,value:"Why should I compile my project with react-native-builder-bob?",id:"why-should-i-compile-my-project-with-react-native-builder-bob"},{depth:2,value:"How do I add a react-native library containing native code as a dependency in my library?",id:"how-do-i-add-a-react-native-library-containing-native-code-as-a-dependency-in-my-library"},{depth:2,value:"How to upgrade the react-native version in the generated project?",id:"how-to-upgrade-the-react-native-version-in-the-generated-project"},{depth:2,value:"How does the library get linked to the example app in the generated project?",id:"how-does-the-library-get-linked-to-the-example-app-in-the-generated-project"},{depth:2,value:"How to test the library in an app locally?",id:"how-to-test-the-library-in-an-app-locally"},{depth:2,value:"Users get a warning when they install my library",id:"users-get-a-warning-when-they-install-my-library"}];function c(e){let n=Object.assign({h1:"h1",h2:"h2",code:"code",p:"p",ul:"ul",li:"li",strong:"strong",ol:"ol",a:"a",pre:"pre",span:"span"},(0,o.a)(),e.components);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{children:"Frequently Asked Questions"}),"\n",(0,s.jsxs)(n.h2,{id:"why-should-i-compile-my-project-with-react-native-builder-bob",children:["Why should I compile my project with ",(0,s.jsx)(n.code,{children:"react-native-builder-bob"}),"?"]}),"\n",(0,s.jsx)(n.p,{children:"We write our library code in non-standard syntaxes such as JSX, TypeScript etc. as well as proposed syntaxes which aren't part of the standard yet. This means that our code needs to be compiled to be able to run on JavaScript engines."}),"\n",(0,s.jsx)(n.p,{children:"When using the library in a React Native app, Metro handles compiling the source code. However, it's also possible to use them in other targets such as web, run in Node for tests or SSR etc. So we need to compile the source code for them as well."}),"\n",(0,s.jsxs)(n.p,{children:["Currently, to handle such multiple targets, we need to have multiple babel configs and write a long ",(0,s.jsx)(n.code,{children:"babel-cli"})," command in our ",(0,s.jsx)(n.code,{children:"package.json"}),". We also need to keep the configs in sync between our projects."]}),"\n",(0,s.jsxs)(n.p,{children:["Just as an example, this is a command we have in one of the packages: ",(0,s.jsx)(n.code,{children:"babel --extensions '.js,.ts,.tsx' --no-babelrc --config-file=./babel.config.publish.js src --ignore '**/__tests__/**' --copy-files --source-maps --delete-dir-on-start --out-dir dist && del-cli 'dist/**/__tests__' && yarn tsc --emitDeclarationOnly"}),". This isn't all, there's even a separate ",(0,s.jsx)(n.code,{children:"babel.config.publish.js"})," file. And this only works for webpack and Metro, and will fail on Node due to ESM usage."]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"react-native-builder-bob"})," wraps tools such as ",(0,s.jsx)(n.code,{children:"babel"})," and ",(0,s.jsx)(n.code,{children:"typescript"})," to simplify these common tasks across multiple projects. It's tailored specifically to React Native projects to minimize the configuration required."]}),"\n",(0,s.jsx)(n.h2,{id:"how-do-i-add-a-react-native-library-containing-native-code-as-a-dependency-in-my-library",children:"How do I add a react-native library containing native code as a dependency in my library?"}),"\n",(0,s.jsx)(n.p,{children:"If your library depends on another react-native library containing native code, you should do the following:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["Add the native library to ",(0,s.jsx)(n.code,{children:"peerDependencies"})]})}),"\n",(0,s.jsxs)(n.p,{children:["This means that the consumer of the library will need to install the native library and add it to the ",(0,s.jsx)(n.code,{children:"dependencies"})," section of their ",(0,s.jsx)(n.code,{children:"package.json"}),". It makes sure that:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"There are no version conflicts if another package also happens to use the same library, or if the user wants to use the library in their app. While there can be multiple versions of a JavaScript-only library, there can only be one version of a native library - so avoiding version conflicts is important."}),"\n",(0,s.jsx)(n.li,{children:"The package manager installs it in correct location so that autolinking can work properly."}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["Don't add the native library to ",(0,s.jsx)(n.code,{children:"dependencies"})," of your library, otherwise it may cause issues for the user even if it seems to work."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["Add the native library to ",(0,s.jsx)(n.code,{children:"devDependencies"})]})}),"\n",(0,s.jsx)(n.p,{children:"This makes sure that you can use it for tests, and there are no other errors such as type errors due to the missing module."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["Add the native library to ",(0,s.jsx)(n.code,{children:"dependencies"})," in the ",(0,s.jsx)(n.code,{children:"package.json"})," under ",(0,s.jsx)(n.code,{children:"example"})]})}),"\n",(0,s.jsx)(n.p,{children:"This is equivalent to the consumer of the library installing the dependency, and is needed so that this module is also available to the example app."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.h2,{id:"how-to-upgrade-the-react-native-version-in-the-generated-project",children:["How to upgrade the ",(0,s.jsx)(n.code,{children:"react-native"})," version in the generated project?"]}),"\n",(0,s.jsxs)(n.p,{children:["Since this is a library, the ",(0,s.jsx)(n.code,{children:"react-native"})," version specified in the ",(0,s.jsx)(n.code,{children:"package.json"})," is not relevant for the consumers. It's only used for developing and testing the library. If you'd like to upgrade the ",(0,s.jsx)(n.code,{children:"react-native"})," version to test with it, you'd need to:"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Bump versions of the following packages under ",(0,s.jsx)(n.code,{children:"devDependencies"})," in the ",(0,s.jsx)(n.code,{children:"package.json"}),":"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"react-native"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"react"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"@types/react"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.code,{children:"@types/react-native"})}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["If you have any other related packages such as ",(0,s.jsx)(n.code,{children:"react-test-renderer"}),", make sure to bump them as well."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Upgrade ",(0,s.jsx)(n.code,{children:"react-native"})," in the ",(0,s.jsx)(n.code,{children:"example"})," app."]}),"\n",(0,s.jsxs)(n.p,{children:["The example app is a React Native app that can be updated following the same process as a regular React Native app. The process will vary depending on if it's using ",(0,s.jsx)(n.a,{href:"https://expo.io",children:"Expo"})," or ",(0,s.jsx)(n.a,{href:"https://github.com/react-native-community/cli",children:"React Native CLI"}),". See the ",(0,s.jsx)(n.a,{href:"https://reactnative.dev/docs/upgrading",children:"official upgrade guide"})," for more details."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["To avoid issues, make sure that the versions of ",(0,s.jsx)(n.code,{children:"react"})," and ",(0,s.jsx)(n.code,{children:"react-native"})," are the same in ",(0,s.jsx)(n.code,{children:"example/package.json"})," and the ",(0,s.jsx)(n.code,{children:"package.json"})," at the root."]}),"\n",(0,s.jsx)(n.h2,{id:"how-does-the-library-get-linked-to-the-example-app-in-the-generated-project",children:"How does the library get linked to the example app in the generated project?"}),"\n",(0,s.jsxs)(n.p,{children:["If you generate a project with ",(0,s.jsx)(n.code,{children:"create-react-native-library"}),", you get an example app to test your library. It's good to understand how the library gets linked to the example app in case you want to tweak how it works or if you run into issues."]}),"\n",(0,s.jsx)(n.p,{children:"There are 2 parts to this process."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Aliasing the JavaScript code"})}),"\n",(0,s.jsxs)(n.p,{children:["The JavaScript (or TypeScript) source code is aliased to be used by the example app. This makes it so that when you import from ",(0,s.jsx)(n.code,{children:"'your-library-name'"}),", it imports the source code directly and avoids having to rebuild the library for JavaScript only changes. We configure several tools to make this work:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://babeljs.io",children:"Babel"})," is configured to use the alias in ",(0,s.jsx)(n.code,{children:"example/babel.config.js"})," using ",(0,s.jsx)(n.a,{href:"https://github.com/tleunen/babel-plugin-module-resolver",children:"babel-plugin-module-resolver"}),". This transforms the imports to point to the source code instead."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://facebook.github.io/metro/",children:"Metro"})," is configured to allow importing from outside of the ",(0,s.jsx)(n.code,{children:"example"})," directory by configuring ",(0,s.jsx)(n.code,{children:"watchFolders"}),", and to use the appropriate peer dependencies. This configuration exists in the ",(0,s.jsx)(n.code,{children:"example/metro.config.js"})," file."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://webpack.js.org/",children:"Webpack"})," is configured to compile the library source code when running on the Web. This configuration exists in the ",(0,s.jsx)(n.code,{children:"example/webpack.config.js"})," file."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://www.typescriptlang.org/",children:"TypeScript"})," is configured to use the source code for type checking by using the ",(0,s.jsx)(n.code,{children:"paths"})," property under ",(0,s.jsx)(n.code,{children:"compilerOptions"}),". This configuration exists in the ",(0,s.jsx)(n.code,{children:"tsconfig.json"})," file at the root."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Linking the native code"})}),"\n",(0,s.jsxs)(n.p,{children:["By default, React Native CLI only links the modules installed under ",(0,s.jsx)(n.code,{children:"node_module"})," of the app. To be able to link the ",(0,s.jsx)(n.code,{children:"android"})," and ",(0,s.jsx)(n.code,{children:"ios"})," folders from the project root, the path is specified in the ",(0,s.jsx)(n.code,{children:"example/react-native.config.js"})," file."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"how-to-test-the-library-in-an-app-locally",children:"How to test the library in an app locally?"}),"\n",(0,s.jsxs)(n.p,{children:["You may have come across the ",(0,s.jsx)(n.code,{children:"yarn link"})," and ",(0,s.jsx)(n.code,{children:"npm link"})," commands to test libraries locally. These commands work great for simple packages without build process, but they have different behavior from how a published package works."]}),"\n",(0,s.jsx)(n.p,{children:"For more accurate testing, we recommend following approaches:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsxs)(n.strong,{children:["Local tarball with ",(0,s.jsx)(n.code,{children:"npm"})]})}),"\n",(0,s.jsxs)(n.p,{children:["First, temporarily change the version in ",(0,s.jsx)(n.code,{children:"package.json"})," to something like ",(0,s.jsx)(n.code,{children:"0.0.0-local.0"}),". This version number needs to be updated to something different every time you do this to avoid ",(0,s.jsx)(n.a,{href:"https://github.com/yarnpkg/yarn/issues/6811",children:"stale content"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Run the following command inside your library's root:"}),"\n",(0,s.jsx)(n.pre,{"data-language":"sh","data-theme":"default",children:(0,s.jsx)(n.code,{"data-language":"sh","data-theme":"default",children:(0,s.jsxs)(n.span,{className:"line",children:[(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"npm"}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"pack"})]})})}),"\n",(0,s.jsxs)(n.p,{children:["This will generate a file like ",(0,s.jsx)(n.code,{children:"your-library-name-0.0.0-local.0.tgz"})," in the root of the project."]}),"\n",(0,s.jsx)(n.p,{children:"Then, you can install the tarball in your app:"}),"\n",(0,s.jsx)(n.pre,{"data-language":"sh","data-theme":"default",children:(0,s.jsx)(n.code,{"data-language":"sh","data-theme":"default",children:(0,s.jsxs)(n.span,{className:"line",children:[(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"yarn"}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"add"}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"../path/to/your-library-name-0.0.0-local.0.tgz"})]})})}),"\n",(0,s.jsxs)(n.p,{children:["Or if you use ",(0,s.jsx)(n.code,{children:"npm"}),":"]}),"\n",(0,s.jsx)(n.pre,{"data-language":"sh","data-theme":"default",children:(0,s.jsx)(n.code,{"data-language":"sh","data-theme":"default",children:(0,s.jsxs)(n.span,{className:"line",children:[(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"npm"}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"install"}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"../path/to/your-library-name-0.0.0-local.0.tgz"})]})})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Verdaccio"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://verdaccio.org/",children:"Verdaccio"})," is a lightweight private npm registry that can be used to test packages locally. The advantage of using Verdaccio is that it allows to test the complete workflow of publishing and installing a package without actually publishing it to a remote registry."]}),"\n",(0,s.jsxs)(n.p,{children:["You can find installation and usage instructions in the ",(0,s.jsx)(n.a,{href:"https://verdaccio.org/docs/en/installation",children:"Verdaccio documentation"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"users-get-a-warning-when-they-install-my-library",children:"Users get a warning when they install my library"}),"\n",(0,s.jsx)(n.p,{children:"If users are using Yarn 1, they may get a warning when installing your library:"}),"\n",(0,s.jsx)(n.pre,{"data-language":"sh","data-theme":"default",children:(0,s.jsx)(n.code,{"data-language":"sh","data-theme":"default",children:(0,s.jsxs)(n.span,{className:"line",children:[(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-function)"},children:"warning"}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"Workspaces"}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"can"}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"only"}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"be"}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"enabled"}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"in"}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"private"}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-string)"},children:"projects."})]})})}),"\n",(0,s.jsxs)(n.p,{children:["This is because the example app is configured as a Yarn workspace, and there is a ",(0,s.jsx)(n.a,{href:"https://github.com/yarnpkg/yarn/issues/8580",children:"bug in Yarn 1"})," which causes this warning to be shown for third-party packages. It has no impact for the consumers of the library and the warning can be ignored. If consumers would like to get rid of the warning, there are 2 options:"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Disable workspaces"})}),"\n",(0,s.jsxs)(n.p,{children:["If the consumer doesn't use Yarn workspaces, they can disable it by adding the following to the ",(0,s.jsx)(n.code,{children:".yarnrc"})," file in the root of their project:"]}),"\n",(0,s.jsx)(n.pre,{"data-language":"rc","data-theme":"default",children:(0,s.jsx)(n.code,{"data-language":"rc","data-theme":"default",children:(0,s.jsx)(n.span,{className:"line",children:(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:"workspaces-experimental false"})})})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Upgrade to Yarn 3"})}),"\n",(0,s.jsxs)(n.p,{children:["Yarn 1 is no longer maintained, so it's recommended to upgrade to Yarn 3. Yarn 3 works with React Native projects with the ",(0,s.jsx)(n.code,{children:"node-modules"})," linker. To upgrade, consumers can follow the ",(0,s.jsx)(n.a,{href:"https://yarnpkg.com/migration/guide",children:"official upgrade guide"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["It's also necessary to use ",(0,s.jsx)(n.code,{children:"node-modules"})," linker. To use it, consumers can add the following to the ",(0,s.jsx)(n.code,{children:".yarnrc.yml"})," file in the root of their project:"]}),"\n",(0,s.jsx)(n.pre,{"data-language":"yml","data-theme":"default",children:(0,s.jsx)(n.code,{"data-language":"yml","data-theme":"default",children:(0,s.jsxs)(n.span,{className:"line",children:[(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:"nodeLinker"}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-keyword)"},children:":"}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-color-text)"},children:" "}),(0,s.jsx)(n.span,{style:{color:"var(--shiki-token-string-expression)"},children:"node-modules"})]})})}),"\n"]}),"\n"]})]})}let d={MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:n}=Object.assign({},(0,o.a)(),e.components);return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)},pageOpts:{filePath:"pages/faq.md",route:"/faq",pageMap:[{kind:"Meta",data:{index:"Introduction",create:"Scaffold a library",build:"Build a library",faq:"FAQ"}},{kind:"MdxPage",name:"build",route:"/build"},{kind:"MdxPage",name:"create",route:"/create"},{kind:"MdxPage",name:"faq",route:"/faq"},{kind:"MdxPage",name:"index",route:"/"}],flexsearch:{codeblocks:!0},title:"Frequently Asked Questions",headings:l},pageNextRoute:"/faq",nextraLayout:r.ZP,themeConfig:a.Z};n.default=(0,t.j)(d)},6282:function(e,n,i){"use strict";var s=i(4246);i(7378),n.Z={primaryHue:30,logo:(0,s.jsx)("span",{style:{fontSize:"32px"},children:"\uD83D\uDC77‍♂️"}),project:{link:"https://github.com/callstack/react-native-builder-bob"},docsRepositoryBase:"https://github.com/callstack/react-native-builder-bob/tree/main/docs"}}},function(e){e.O(0,[774,571,888,179],function(){return e(e.s=7040)}),_N_E=e.O()}]);